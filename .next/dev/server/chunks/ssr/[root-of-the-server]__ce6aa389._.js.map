{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///tmp/reembolso-system/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\n\ninterface Reembolso {\n  id: string;\n  atribuido: string | null;\n  data: string | null;\n  anoReferencia: number | null;\n  processo: string | null;\n  upm: string | null;\n  beneficiario: string | null;\n  requerente: string | null;\n  solicitado: number | null;\n  cpfTitular: string | null;\n  especialidade: string | null;\n  decisao: string | null;\n  resultado: string | null;\n  pagamento: string | null;\n}\n\ninterface PaginacaoInfo {\n  page: number;\n  limit: number;\n  total: number;\n  totalPages: number;\n}\n\nexport default function Home() {\n  const [registros, setRegistros] = useState<Reembolso[]>([]);\n  const [paginacao, setPaginacao] = useState<PaginacaoInfo>({\n    page: 1,\n    limit: 25,\n    total: 0,\n    totalPages: 0,\n  });\n  const [soma, setSoma] = useState(0);\n  const [anos, setAnos] = useState<number[]>([]);\n  const [busca, setBusca] = useState('');\n  const [filtros, setFiltros] = useState<any>({});\n  const [carregando, setCarregando] = useState(false);\n  const [importando, setImportando] = useState(false);\n  const [mensagem, setMensagem] = useState('');\n  const [mostrarFiltros, setMostrarFiltros] = useState(false);\n\n  useEffect(() => {\n    carregarDados();\n  }, [paginacao.page, filtros]);\n\n  async function carregarDados() {\n    setCarregando(true);\n    try {\n      const params = new URLSearchParams({\n        page: paginacao.page.toString(),\n        limit: paginacao.limit.toString(),\n        search: busca,\n        ...filtros,\n      });\n\n      const response = await fetch(`/api/reembolsos?${params}`);\n      const data = await response.json();\n\n      setRegistros(data.registros);\n      setPaginacao(data.paginacao);\n      setSoma(data.soma);\n\n      if (data.registros.length > 0) {\n        const anosUnicos = Array.from(\n          new Set(\n            data.registros\n              .map((r: Reembolso) => r.anoReferencia)\n              .filter(Boolean)\n          )\n        ).sort((a, b) => (b as number) - (a as number)) as number[];\n        setAnos(anosUnicos);\n      }\n    } catch (error) {\n      setMensagem('Erro ao carregar dados');\n      console.error(error);\n    } finally {\n      setCarregando(false);\n    }\n  }\n\n  async function handleImportar(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setImportando(true);\n    setMensagem('');\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const response = await fetch('/api/import', {\n        method: 'POST',\n        body: formData,\n      });\n\n      const resultado = await response.json();\n\n      if (response.ok) {\n        setMensagem(\n          `‚úì Importa√ß√£o conclu√≠da: ${resultado.totalInserido} inseridos, ${resultado.totalAtualizado} atualizados`\n        );\n        carregarDados();\n      } else {\n        setMensagem(`‚úó Erro: ${resultado.error}`);\n      }\n    } catch (error) {\n      setMensagem('Erro ao importar arquivo');\n      console.error(error);\n    } finally {\n      setImportando(false);\n    }\n  }\n\n  function handleBusca(e: React.ChangeEvent<HTMLInputElement>) {\n    setBusca(e.target.value);\n    setPaginacao(prev => ({ ...prev, page: 1 }));\n  }\n\n  function handleAplicarFiltros() {\n    setPaginacao(prev => ({ ...prev, page: 1 }));\n  }\n\n  function handleLimparFiltros() {\n    setFiltros({});\n    setBusca('');\n    setPaginacao(prev => ({ ...prev, page: 1 }));\n  }\n\n  function handleExportar(formato: 'csv' | 'excel') {\n    const params = new URLSearchParams({\n      formato,\n      search: busca,\n      ...filtros,\n    });\n\n    window.location.href = `/api/export?${params}`;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"mb-6\">\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n            Painel de Reembolso 2025+\n          </h1>\n          <p className=\"text-gray-600\">\n            Gerencie reembolsos com importa√ß√£o, cadastro cont√≠nuo e filtros avan√ßados\n          </p>\n        </div>\n\n        {mensagem && (\n          <div\n            className={`mb-4 p-4 rounded ${\n              mensagem.startsWith('‚úì')\n                ? 'bg-green-100 text-green-800'\n                : 'bg-red-100 text-red-800'\n            }`}\n          >\n            {mensagem}\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n          <div className=\"bg-white p-4 rounded-lg shadow\">\n            <p className=\"text-gray-600 text-sm\">Total de Registros</p>\n            <p className=\"text-2xl font-bold\">{paginacao.total}</p>\n          </div>\n          <div className=\"bg-white p-4 rounded-lg shadow\">\n            <p className=\"text-gray-600 text-sm\">Registros Filtrados</p>\n            <p className=\"text-2xl font-bold\">{registros.length}</p>\n          </div>\n          <div className=\"bg-white p-4 rounded-lg shadow\">\n            <p className=\"text-gray-600 text-sm\">Soma Solicitado (Filtrado)</p>\n            <p className=\"text-2xl font-bold\">\n              R$ {soma.toLocaleString('pt-BR', {\n                minimumFractionDigits: 2,\n                maximumFractionDigits: 2,\n              })}\n            </p>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow mb-6\">\n          <div className=\"flex flex-col md:flex-row gap-4 mb-4\">\n            <input\n              type=\"text\"\n              placeholder=\"Busca r√°pida (processo, benefici√°rio, CPF...)\"\n              value={busca}\n              onChange={handleBusca}\n              className=\"flex-1 px-4 py-2 border rounded\"\n            />\n\n            <div className=\"flex gap-2 flex-wrap\">\n              <Link\n                href=\"/reembolsos/novo\"\n                className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\n              >\n                + Novo Registro\n              </Link>\n\n              <label className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 cursor-pointer\">\n                üì§ Importar Excel\n                <input\n                  type=\"file\"\n                  accept=\".xlsx,.xls\"\n                  onChange={handleImportar}\n                  disabled={importando}\n                  className=\"hidden\"\n                />\n              </label>\n\n              <button\n                onClick={() => handleExportar('csv')}\n                className=\"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700\"\n              >\n                üì• Exportar CSV\n              </button>\n\n              <button\n                onClick={() => handleExportar('excel')}\n                className=\"px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-700\"\n              >\n                üì• Exportar Excel\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow overflow-x-auto\">\n          {carregando ? (\n            <div className=\"p-8 text-center\">Carregando...</div>\n          ) : registros.length === 0 ? (\n            <div className=\"p-8 text-center text-gray-500\">\n              Nenhum registro encontrado\n            </div>\n          ) : (\n            <>\n              <table className=\"w-full text-sm\">\n                <thead className=\"bg-gray-100 border-b\">\n                  <tr>\n                    <th className=\"px-4 py-2 text-left\">DATA</th>\n                    <th className=\"px-4 py-2 text-left\">ANO</th>\n                    <th className=\"px-4 py-2 text-left\">PROCESSO</th>\n                    <th className=\"px-4 py-2 text-left\">UPM</th>\n                    <th className=\"px-4 py-2 text-left\">BENEFICI√ÅRIO</th>\n                    <th className=\"px-4 py-2 text-left\">REQUERENTE</th>\n                    <th className=\"px-4 py-2 text-right\">SOLICITADO</th>\n                    <th className=\"px-4 py-2 text-left\">ESPECIALIDADE</th>\n                    <th className=\"px-4 py-2 text-left\">DECIS√ÉO</th>\n                    <th className=\"px-4 py-2 text-left\">RESULTADO</th>\n                    <th className=\"px-4 py-2 text-left\">PAGAMENTO</th>\n                    <th className=\"px-4 py-2 text-left\">ATRIBUIDO</th>\n                    <th className=\"px-4 py-2 text-center\">A√á√ïES</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {registros.map((registro) => (\n                    <tr key={registro.id} className=\"border-b hover:bg-gray-50\">\n                      <td className=\"px-4 py-2\">\n                        {registro.data\n                          ? new Date(registro.data).toLocaleDateString('pt-BR')\n                          : '-'}\n                      </td>\n                      <td className=\"px-4 py-2\">{registro.anoReferencia || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.processo || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.upm || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.beneficiario || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.requerente || '-'}</td>\n                      <td className=\"px-4 py-2 text-right\">\n                        {registro.solicitado\n                          ? `R$ ${registro.solicitado.toLocaleString('pt-BR', {\n                              minimumFractionDigits: 2,\n                              maximumFractionDigits: 2,\n                            })}`\n                          : '-'}\n                      </td>\n                      <td className=\"px-4 py-2\">{registro.especialidade || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.decisao || '-'}</td>\n                      <td className=\"px-4 py-2\">{registro.resultado || '-'}</td>\n                      <td className=\"px-4 py-2\">\n                        {registro.pagamento\n                          ? new Date(registro.pagamento).toLocaleDateString('pt-BR')\n                          : '-'}\n                      </td>\n                      <td className=\"px-4 py-2\">{registro.atribuido || '-'}</td>\n                      <td className=\"px-4 py-2 text-center\">\n                        <Link\n                          href={`/reembolsos/${registro.id}`}\n                          className=\"text-blue-600 hover:text-blue-800\"\n                        >\n                          Ver\n                        </Link>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n\n              <div className=\"flex justify-between items-center p-4 border-t\">\n                <button\n                  onClick={() => setPaginacao(prev => ({ ...prev, page: prev.page - 1 }))}\n                  disabled={paginacao.page === 1}\n                  className=\"px-4 py-2 bg-gray-200 rounded disabled:opacity-50\"\n                >\n                  Anterior\n                </button>\n                <span>\n                  P√°gina {paginacao.page} de {paginacao.totalPages}\n                </span>\n                <button\n                  onClick={() => setPaginacao(prev => ({ ...prev, page: prev.page + 1 }))}\n                  disabled={paginacao.page === paginacao.totalPages}\n                  className=\"px-4 py-2 bg-gray-200 rounded disabled:opacity-50\"\n                >\n                  Pr√≥xima\n                </button>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}